## Context

MetaCubeXD 的 Proxies 页面展示代理组和节点列表，用户可以手动测试单个节点延迟。现有 `composables/useLatencyTest.ts` 提供延迟测试功能。用户面对大量节点时难以快速选择最佳节点。

## Goals / Non-Goals

**Goals:**

- 实现一键批量延迟测试
- 基于多维度指标计算节点评分
- 智能推荐最佳节点
- 追踪节点历史性能

**Non-Goals:**

- 不实现自动负载均衡
- 不考虑节点地理位置优化
- 不实现 A/B 测试节点切换

## Decisions

### 1. 节点评分算法

**决定**: 综合评分 = 延迟权重(50%) + 稳定性权重(30%) + 成功率权重(20%)

- 延迟分数：基于延迟值的归一化分数（越低越好）
- 稳定性分数：基于最近 N 次延迟的标准差（越小越好）
- 成功率分数：最近 N 次测试的成功比例

**理由**:

- 延迟是最直观的指标
- 稳定性避免选中波动大的节点
- 成功率排除频繁失败的节点

### 2. 批量测试策略

**决定**: 并发测试，每批最多 10 个节点，批次间隔 200ms。

**理由**:

- 并发提高效率
- 限制并发数避免后端过载
- 间隔避免瞬时流量峰值

### 3. 历史数据存储

**决定**: 使用 localStorage 存储最近 20 次测试结果（每节点）。

**理由**:

- 数据量小，localStorage 足够
- 不需要复杂查询
- 简化实现

### 4. 推荐展示方式

**决定**: 在节点卡片上显示评分和推荐标记，代理组标题旁显示"一键切换到推荐"按钮。

**理由**:

- 评分可视化帮助用户理解
- 推荐操作便捷

## Risks / Trade-offs

| 风险                       | 缓解措施                               |
| -------------------------- | -------------------------------------- |
| 批量测试增加后端负载       | 限制并发数，提供测试间隔配置           |
| 历史数据可能过时           | 显示最后测试时间，超过阈值提示重新测试 |
| 评分算法可能不适合所有场景 | 允许用户调整权重参数                   |
