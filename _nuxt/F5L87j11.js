import{_ as le}from"./B2K3yxlf.js";import{e as P,A as ce,o as r,c as _,b as h,i as e,w as N,a as t,z as O,f as de,C as F,M as te,p as ue,n as k,l as L,T as fe,q as oe,F as V,r as q,t as y,m as T,N as J,y as E,J as ge,s as xe,E as j,R as ye,j as He,a1 as Oe,g as ie,W as ee,Q as je,O as Pe,B as Re,a2 as Be,a0 as Ne}from"./CRZAT9oH.js";import{u as ke,a as we,o as Ce,f as Te,b as Me}from"./BlSi6R5X.js";import{c as Q}from"./qqqfUOwc.js";import{_ as Ue,b as Ae,u as pe,S as We,f as Ve,a as Fe}from"./FXH5OMOc.js";import{u as G}from"./Dw963Xf9.js";import{b as Ge,a as Ke,I as Xe}from"./BP7JH15r.js";import{I as Ye,u as Je}from"./f_HB2hkb.js";import{I as qe}from"./CuaAfGgN.js";import{I as Qe}from"./C2N-YNw5.js";import{_ as Se}from"./DlAUqK2U.js";import{e as Ee,f as Ze}from"./BD4k13ts.js";import{a as $e,b as et}from"./BdeBlCSG.js";import{u as me}from"./lWwe4MHH.js";import{a as Y,I as A,H as be}from"./DadOHqRk.js";import{I as tt}from"./B2RYdIxK.js";import{I as ot}from"./DwBSywMz.js";import{h as _e}from"./Du_FUPRh.js";import{R as W}from"./vIF72wqi.js";import"./Ci9bsD2k.js";var st=Q("outline","home","Home",[["path",{d:"M5 12l-2 0l9 -9l9 9l-2 0",key:"svg-0"}],["path",{d:"M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7",key:"svg-1"}],["path",{d:"M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6",key:"svg-2"}]]);var nt=Q("outline","language","Language",[["path",{d:"M9 6.371c0 4.418 -2.239 6.629 -5 6.629",key:"svg-0"}],["path",{d:"M4 6.371h7",key:"svg-1"}],["path",{d:"M5 9c0 2.144 2.252 3.908 6 4",key:"svg-2"}],["path",{d:"M12 20l4 -9l4 9",key:"svg-3"}],["path",{d:"M19.1 18h-6.2",key:"svg-4"}],["path",{d:"M6.694 3l.793 .582",key:"svg-5"}]]);var at=Q("outline","menu-2","Menu2",[["path",{d:"M4 6l16 0",key:"svg-0"}],["path",{d:"M4 12l16 0",key:"svg-1"}],["path",{d:"M4 18l16 0",key:"svg-2"}]]);var rt=Q("outline","palette","Palette",[["path",{d:"M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25",key:"svg-0"}],["path",{d:"M7.5 10.5a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M11.5 7.5a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}],["path",{d:"M15.5 10.5a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-3"}]]);var it=Q("outline","ruler","Ruler",[["path",{d:"M5 4h14a1 1 0 0 1 1 1v5a1 1 0 0 1 -1 1h-7a1 1 0 0 0 -1 1v7a1 1 0 0 1 -1 1h-5a1 1 0 0 1 -1 -1v-14a1 1 0 0 1 1 -1",key:"svg-0"}],["path",{d:"M4 8l2 0",key:"svg-1"}],["path",{d:"M4 12l3 0",key:"svg-2"}],["path",{d:"M4 16l2 0",key:"svg-3"}],["path",{d:"M8 4l0 2",key:"svg-4"}],["path",{d:"M12 4l0 3",key:"svg-5"}],["path",{d:"M16 4l0 2",key:"svg-6"}]]);const lt={class:"flex min-w-0 items-center gap-1 text-sm font-bold whitespace-nowrap uppercase sm:text-xl"},ct=P({__name:"LogoText",setup(w){const o=ce(),n=O(()=>!!o.currentEndpoint);return(a,s)=>{const d=le;return r(),_("div",lt,[h(d,{class:"bg-gradient-to-br from-primary to-secondary bg-clip-text text-transparent no-underline",to:e(n)?"/":"/setup"},{default:N(()=>[...s[0]||(s[0]=[t("span",{class:"hidden min-[400px]:inline"},"metacube",-1),t("span",{class:"inline min-[400px]:hidden"},"mcx",-1)])]),_:1},8,["to"]),s[1]||(s[1]=t("span",{class:"text-base-content"},"(",-1)),s[2]||(s[2]=t("a",{class:"inline-block text-primary no-underline transition-transform duration-300 ease-in-out hover:scale-125 hover:rotate-90",href:"https://github.com/metacubex/metacubexd",target:"_blank"}," xd ",-1)),s[3]||(s[3]=t("span",{class:"text-base-content"},")",-1))])}}}),dt=Object.assign(ct,{__name:"LogoText"}),ut={class:"relative"},ft={class:"m-0 list-none p-1.5"},pt=["onClick"],mt={key:0,class:"flex h-4 w-4 items-center justify-center text-primary"},ht=P({__name:"LangSwitcher",setup(w){const{locale:o,locales:n,setLocale:a}=de(),s=O(()=>n.value.map(C=>typeof C=="string"?{code:C,name:C}:C)),d=E(null),u=E(null),c=E(!1),{floatingStyles:f}=ke(d,u,{placement:"top",middleware:[Ce(10),Te(),Me({padding:8})],whileElementsMounted:we});function v(){c.value=!c.value}function g(C){a(C),c.value=!1}function b(C){const x=C.target;!d.value?.contains(x)&&!u.value?.contains(x)&&(c.value=!1)}return F(()=>{document.addEventListener("click",b)}),te(()=>{document.removeEventListener("click",b)}),(C,x)=>(r(),_("div",ut,[t("button",{ref_key:"reference",ref:d,class:k(["flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border-none bg-transparent text-base-content/70 transition-all duration-200 ease-in-out hover:bg-base-content/10 hover:text-base-content",{"bg-primary/15 text-primary":e(c)}]),"aria-label":"Change language",onClick:ue(v,["stop"])},[h(e(nt),{size:18})],2),(r(),L(J,{to:"body"},[h(fe,{"enter-active-class":"transition-opacity duration-150","leave-active-class":"transition-opacity duration-100","enter-from-class":"opacity-0","leave-to-class":"opacity-0"},{default:N(()=>[e(c)?(r(),_("div",{key:0,ref_key:"floating",ref:u,style:oe(e(f)),class:"z-70 w-40 overflow-hidden rounded-xl border border-base-content/10 bg-base-300/98 shadow-[0_10px_40px_var(--color-base-content)/20,0_0_0_1px_var(--color-base-content)/5] backdrop-blur-[12px]"},[x[1]||(x[1]=t("div",{class:"flex items-center border-b border-base-content/8 bg-base-200/60 px-3 py-2.5"},[t("span",{class:"text-[0.6875rem] font-semibold tracking-[0.05em] text-base-content/50 uppercase"},"Language")],-1)),t("ul",ft,[(r(!0),_(V,null,q(e(s),p=>(r(),_("li",{key:p.code},[t("button",{class:k(["flex w-full cursor-pointer items-center justify-between rounded-lg border-none bg-transparent px-2.5 py-2 transition-all duration-150 ease-in-out hover:bg-base-content/8",{"bg-primary/15 hover:bg-primary/20":e(o)===p.code}]),onClick:m=>g(p.code)},[t("span",{class:k(["text-[0.8125rem] font-medium text-base-content",{"text-primary":e(o)===p.code}])},y(p.name),3),e(o)===p.code?(r(),_("div",mt,[...x[0]||(x[0]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"h-full w-full"},[t("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1)])])):T("",!0)],10,pt)]))),128))])],4)):T("",!0)]),_:1})]))]))}}),vt=Object.assign(ht,{__name:"LangSwitcher"}),bt={class:"relative"},_t=P({__name:"ThemeSwitcher",setup(w){const o=G(),n=E(null),a=E(null),s=E(!1),{floatingStyles:d}=ke(n,a,{placement:"top",middleware:[Ce(10),Te(),Me({padding:8})],whileElementsMounted:we});function u(){s.value=!s.value}function c(v){o.curTheme=v,document.documentElement.setAttribute("data-theme",v),s.value=!1}function f(v){const g=v.target;!n.value?.contains(g)&&!a.value?.contains(g)&&(s.value=!1)}return F(()=>{document.addEventListener("click",f)}),te(()=>{document.removeEventListener("click",f)}),(v,g)=>{const b=Ue;return r(),_("div",bt,[t("button",{ref_key:"reference",ref:n,class:k(["flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border-none bg-primary text-primary-content transition-all duration-200 ease-in-out hover:scale-110 hover:shadow-[0_4px_12px_oklch(var(--p)/0.4)]",{"scale-110 rotate-[15deg]":e(s)}]),onClick:ue(u,["stop"])},[h(e(rt),{size:18})],2),(r(),L(J,{to:"body"},[h(fe,{"enter-active-class":"transition-opacity duration-150","leave-active-class":"transition-opacity duration-100","enter-from-class":"opacity-0","leave-to-class":"opacity-0"},{default:N(()=>[e(s)?(r(),_("div",{key:0,ref_key:"floating",ref:a,style:oe(e(d)),class:"z-70 w-44 overflow-hidden rounded-xl shadow-lg"},[g[0]||(g[0]=t("div",{class:"flex items-center border-b border-gray-700 bg-gray-800/90 px-3 py-2"},[t("span",{class:"text-[0.6875rem] font-semibold tracking-[0.05em] text-gray-400 uppercase"}," Theme ")],-1)),h(b,{"model-value":e(o).curTheme,"onUpdate:modelValue":c},null,8,["model-value"])],4)):T("",!0)]),_:1})]))])}}}),gt=Object.assign(_t,{__name:"ThemeSwitcher"}),xt={class:"mx-2 mb-2 overflow-hidden rounded-2xl shadow-lg backdrop-blur-[12px]",style:{border:"1px solid color-mix(in oklch, var(--color-base-content) 10%, transparent)",background:"color-mix(in oklch, var(--color-base-300) 90%, transparent)"}},yt={class:"grid h-16 grid-cols-6"},kt={class:"sr-only"},wt=P({__name:"MobileBottomNav",props:{navItems:{}},setup(w){const o=ge(),n=s=>o.path===s,a=E(!1);return F(()=>{requestAnimationFrame(()=>{a.value=!0})}),(s,d)=>{const u=le;return r(),_("nav",{"aria-label":"Mobile bottom navigation",class:k(["fixed inset-x-0 bottom-0 z-50 transition-all duration-500 ease-[cubic-bezier(0.22,1,0.36,1)] lg:hidden",e(a)?"translate-y-0 opacity-100":"translate-y-full opacity-0"])},[t("div",xt,[t("div",yt,[(r(!0),_(V,null,q(w.navItems,c=>(r(),L(u,{key:c.href,to:c.href,class:k(["group relative flex flex-col items-center justify-center gap-0.5 no-underline transition-all duration-300 ease-in-out active:scale-90",n(c.href)?"text-primary":"text-base-content/60 hover:text-base-content"])},{default:N(()=>[t("div",{class:k(["absolute inset-1 rounded-xl transition-all duration-300 ease-in-out",n(c.href)?"bg-primary/10":"bg-transparent group-hover:bg-base-content/5"])},null,2),t("div",{class:k(["absolute top-1 h-1 rounded-full bg-primary transition-all duration-300 ease-in-out",n(c.href)?"w-8 opacity-100":"w-0 opacity-0"])},null,2),t("div",{class:k(["relative z-10 transition-all duration-300 ease-in-out group-hover:scale-105",n(c.href)?"scale-110 text-xl":"scale-100 text-lg"])},[(r(),L(xe(c.icon)))],2),t("span",kt,y(`Navigate to ${c.name}`),1),t("span",{"aria-hidden":"true",class:k(["relative z-10 text-[10px] font-medium transition-all duration-300 ease-in-out group-hover:opacity-100",n(c.href)?"opacity-100":"opacity-80"])},y(c.name),3)]),_:2},1032,["to","class"]))),128))])])],2)}}}),Ct=Object.assign(wt,{__name:"MobileBottomNav"}),Tt={class:"drawer-content flex h-full flex-col"},Mt={class:"z-50 flex h-14 items-center gap-2 border-b border-[var(--sidebar-border)] bg-[color-mix(in_oklch,var(--color-base-300)_95%,transparent)] px-2 shadow-[0_4px_20px_color-mix(in_oklch,var(--color-base-content)_5%,transparent)] backdrop-blur-[12px] sm:px-4 lg:hidden"},St={key:0,for:"main-drawer",class:"flex h-9 w-9 cursor-pointer items-center justify-center rounded-lg bg-transparent text-base-content transition-all duration-200 ease-in-out hover:bg-[var(--sidebar-hover)]","aria-label":"open sidebar"},Et={class:"min-w-0 shrink"},$t={class:"ml-auto flex shrink-0 items-center gap-1"},Lt={class:"flex min-h-0 flex-1 flex-col p-2 sm:p-4"},Dt={class:"flex min-h-0 flex-1 flex-col"},It={key:0,class:"h-20 shrink-0 lg:hidden","aria-hidden":"true"},zt={key:0,class:"drawer-side z-[60]"},Ht={class:"flex shrink-0 flex-col gap-2 border-b border-[var(--sidebar-border)] p-3"},Ot={class:"flex-1 overflow-y-auto p-2"},jt={class:"m-0 flex list-none flex-col gap-1 p-0"},Pt={class:"flex shrink-0 items-center justify-center transition-transform duration-200 ease-in-out group-hover:scale-110"},Rt={key:0,class:"absolute top-1/2 left-0 h-[60%] w-[3px] -translate-y-1/2 animate-[indicatorIn_0.2s_ease-out] rounded-r-sm bg-primary"},Bt=P({__name:"Sidebar",setup(w){const o=ge(),{t:n}=de(),a=G(),s=O(()=>[{href:"/overview",name:n("overview"),icon:st},{href:"/proxies",name:n("proxies"),icon:qe},{href:"/rules",name:n("rules"),icon:it},{href:"/connections",name:n("connections"),icon:Xe},{href:"/logs",name:n("logs"),icon:Ye},{href:"/config",name:n("config"),icon:Qe}]),d=f=>o.path===f,u=E(null);j(()=>o.path,()=>{u.value&&(u.value.checked=!1)});const c=()=>{a.sidebarExpanded=!a.sidebarExpanded};return(f,v)=>{const g=dt,b=vt,C=gt,x=le,p=Ae,m=Ct;return r(),_("div",{class:k(["drawer h-full [--sidebar-border:color-mix(in_oklch,var(--color-base-content)_10%,transparent)] [--sidebar-hover:color-mix(in_oklch,var(--color-base-content)_5%,transparent)]",{"lg:drawer-open":e(o).path!=="/setup"}])},[t("input",{id:"main-drawer",ref_key:"drawerCheckbox",ref:u,type:"checkbox",class:"drawer-toggle"},null,512),t("div",Tt,[t("header",Mt,[e(o).path!=="/setup"&&!e(a).useMobileBottomNav?(r(),_("label",St,[h(e(at),{class:"h-5 w-5"})])):T("",!0),t("div",Et,[h(g)]),t("div",$t,[v[0]||(v[0]=t("div",{id:"header-traffic-indicator",class:"flex items-center"},null,-1)),h(b),h(C)])]),t("div",Lt,[t("div",Dt,[ye(f.$slots,"default",{},void 0,!0)]),e(a).useMobileBottomNav&&e(o).path!=="/setup"?(r(),_("div",It)):T("",!0)])]),e(o).path!=="/setup"?(r(),_("div",zt,[v[1]||(v[1]=t("label",{for:"main-drawer","aria-label":"close sidebar",class:"drawer-overlay bg-[color-mix(in_oklch,var(--color-base-content)_40%,transparent)] backdrop-blur-[4px]"},null,-1)),t("div",{class:k(["flex h-full w-52 flex-col border-r border-[var(--sidebar-border)] bg-[linear-gradient(180deg,color-mix(in_oklch,var(--color-base-200)_98%,transparent)_0%,var(--color-base-200)_100%)] backdrop-blur-[12px] transition-[width] duration-300 ease-[cubic-bezier(0.4,0,0.2,1)]",e(a).sidebarExpanded?"":"lg:w-16"])},[t("div",Ht,[t("div",{class:k(["flex items-center",e(a).sidebarExpanded?"":"lg:justify-center"])},[He(h(g,{class:"hidden lg:block"},null,512),[[Oe,e(a).sidebarExpanded]]),h(g,{class:"block lg:hidden"})],2),t("button",{class:k(["hidden w-full cursor-pointer items-center justify-center gap-2 rounded-lg border border-[var(--sidebar-border)] bg-transparent p-2 text-sm text-base-content transition-all duration-200 ease-in-out hover:border-[color-mix(in_oklch,var(--color-base-content)_20%,transparent)] hover:bg-[var(--sidebar-hover)] lg:flex",e(a).sidebarExpanded?"":"aspect-square w-auto"]),onClick:c},[e(a).sidebarExpanded?(r(),L(e(Ke),{key:1,class:"h-5 w-5"})):(r(),L(e(Ge),{key:0,class:"h-5 w-5"})),t("span",{class:k(e(a).sidebarExpanded?"":"lg:hidden")},y(e(n)("collapse")),3)],2)]),t("nav",Ot,[t("ul",jt,[(r(!0),_(V,null,q(e(s),(i,$)=>(r(),_("li",{key:i.href,class:"animate-[slideIn_0.3s_ease-out_backwards]",style:oe({animationDelay:`${$*50}ms`})},[h(x,{to:i.href,class:k(["relative flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-sm font-medium text-[color-mix(in_oklch,var(--color-base-content)_70%,transparent)] no-underline transition-all duration-200 ease-in-out hover:bg-[var(--sidebar-hover)] hover:text-base-content",[d(i.href)?"bg-[color-mix(in_oklch,var(--color-primary)_15%,transparent)] !text-primary hover:bg-[color-mix(in_oklch,var(--color-primary)_20%,transparent)]":"",e(a).sidebarExpanded?"":"lg:justify-center lg:px-0"]]),title:e(a).sidebarExpanded?void 0:i.name},{default:N(()=>[t("div",Pt,[(r(),L(xe(i.icon),{class:"h-5 w-5"}))]),t("span",{class:k(["flex-1 overflow-hidden text-ellipsis whitespace-nowrap",e(a).sidebarExpanded?"":"lg:hidden"])},y(i.name),3),d(i.href)?(r(),_("div",Rt)):T("",!0)]),_:2},1032,["to","class","title"])],4))),128))])]),t("div",{class:k(["shrink-0 border-t border-[var(--sidebar-border)] p-2",e(a).sidebarExpanded?"":"lg:flex lg:flex-col lg:items-center"])},[t("div",{id:"sidebar-traffic-expanded",class:k(["mb-2 hidden w-full",e(a).sidebarExpanded?"lg:block":""])},null,2),t("div",{id:"sidebar-traffic-indicator",class:k(["mb-2 hidden w-full lg:block",e(a).sidebarExpanded?"lg:!hidden":""])},null,2),t("div",{class:k(["mb-2 hidden items-center gap-1 lg:flex",e(a).sidebarExpanded?"flex-row":"flex-col"])},[h(b),h(C)],2),h(p,{collapsed:!e(a).sidebarExpanded},null,8,["collapsed"])],2)],2)])):T("",!0),e(a).useMobileBottomNav&&e(o).path!=="/setup"?(r(),L(m,{key:1,"nav-items":e(s)},null,8,["nav-items"])):T("",!0)],2)}}}),Nt=Object.assign(Se(Bt,[["__scopeId","data-v-23b698c5"]]),{__name:"Sidebar"}),Ut=globalThis.setInterval;function At(){const w=ce(),o=$e(),n=me(),a=Je(),s=G();let d=null,u=null,c=null,f=null,v=null;const g=(p,m)=>{const i=w.currentEndpoint;if(!i)return null;const $=w.wsEndpointURL,M=i.secret,D=new URLSearchParams;M&&D.set("token",M);const I=new WebSocket(`${$}/${p}?${D.toString()}`);return I.onmessage=H=>{try{const R=JSON.parse(H.data);m(R)}catch{}},I.onerror=H=>{console.error(`WebSocket error for ${p}:`,H)},I};return{connect:()=>{if(Ee()){const m=Ze();o.updateFromWsMsg({connections:m.mockConnections,uploadTotal:m.mockTrafficStats.up,downloadTotal:m.mockTrafficStats.down}),n.setLatestTraffic(m.mockTrafficStats),n.setLatestMemory(m.mockMemory);const i=Date.now(),$=m.mockConnections.length;for(let M=30;M>=0;M--){const D=i-M*1e3,I=m.mockTrafficStats.down+Math.floor(Math.random()*1e5)-5e4,H=m.mockTrafficStats.up+Math.floor(Math.random()*2e4)-1e4,R=m.mockMemory.inuse+Math.floor(Math.random()*5e6)-25e5,U=$+Math.floor(Math.random()*10)-5;n.addTrafficDataPoint(D,I,H),n.addMemoryDataPoint(D,R),n.addConnectionCountDataPoint(D,U)}m.mockLogs.forEach(M=>{a.addLog(M)}),v=Ut(()=>{const M=Date.now(),D={up:m.mockTrafficStats.up+Math.floor(Math.random()*1e4),down:m.mockTrafficStats.down+Math.floor(Math.random()*5e4)};n.setLatestTraffic(D),n.addTrafficDataPoint(M,D.down,D.up);const I={inuse:m.mockMemory.inuse+Math.floor(Math.random()*5e6)-25e5,oslimit:m.mockMemory.oslimit};n.setLatestMemory(I),n.addMemoryDataPoint(M,I.inuse);const H=m.mockConnections.length+Math.floor(Math.random()*10)-5;n.addConnectionCountDataPoint(M,H)},1e3);return}d=g("connections",m=>{const i=m;if(o.updateFromWsMsg(i),i){const $=i.connections?.length??0;n.addConnectionCountDataPoint(Date.now(),$)}}),u=g("traffic",m=>{const i=m;n.setLatestTraffic(i),n.addTrafficDataPoint(Date.now(),i.down,i.up)}),c=g("memory",m=>{const i=m;n.setLatestMemory(i),n.addMemoryDataPoint(Date.now(),i.inuse)});const p=w.currentEndpoint;if(p){const m=w.wsEndpointURL,i=new URLSearchParams;p.secret&&i.set("token",p.secret),i.set("level",s.logLevel),f=new WebSocket(`${m}/logs?${i.toString()}`),f.onmessage=$=>{try{const M=JSON.parse($.data);a.addLog(M)}catch{}}}},disconnect:()=>{v&&(clearInterval(v),v=null),d?.close(),u?.close(),c?.close(),f?.close(),d=null,u=null,c=null,f=null},reconnectLogs:()=>{f?.close();const p=w.currentEndpoint;if(p){const m=w.wsEndpointURL,i=new URLSearchParams;p.secret&&i.set("token",p.secret),i.set("level",s.logLevel),f=new WebSocket(`${m}/logs?${i.toString()}`),f.onmessage=$=>{try{const M=JSON.parse($.data);a.addLog(M)}catch{}}}}}}const Wt={class:"hidden"},Vt=P({__name:"ProtectedResources",setup(w){const{connect:o,disconnect:n,reconnectLogs:a}=At(),s=G();return F(()=>{o()}),te(()=>{n()}),j(()=>s.logLevel,()=>{a()}),(d,u)=>(r(),_("div",Wt))}}),Ft=Object.assign(Vt,{__name:"ProtectedResources"}),Gt={class:"flex items-center gap-1"},Kt={class:"font-mono text-xs"},Xt={class:"flex items-center gap-1"},Yt={class:"font-mono text-xs"},Jt={class:"flex items-center justify-center gap-1"},qt={class:"font-mono text-xs"},Qt={class:"flex items-center justify-center gap-1"},Zt={class:"font-mono text-xs"},eo={key:0,class:"w-full rounded-lg bg-[color-mix(in_oklch,var(--color-base-100)_50%,transparent)] p-2"},to={class:"grid grid-cols-2 gap-1 text-xs"},oo={class:"flex items-center gap-1"},so={class:"truncate font-mono text-xs"},no={class:"flex items-center gap-1"},ao={class:"truncate font-mono text-xs"},ro={class:"flex items-center gap-1"},io={class:"font-mono text-xs"},lo={class:"flex items-center gap-1"},co={class:"font-mono text-xs"},uo=["title"],fo={class:"flex flex-col gap-2 p-3"},po={class:"flex items-center justify-between gap-2"},mo={class:"text-xs font-semibold uppercase opacity-60"},ho={class:"flex items-center gap-1"},vo=["title"],bo=["title"],_o={class:"grid grid-cols-2 gap-x-4 gap-y-1 text-xs"},go={class:"flex items-center gap-1"},xo={class:"font-mono text-xs font-medium"},yo={class:"flex items-center gap-1"},ko={class:"font-mono text-xs font-medium"},wo={class:"flex items-center gap-1 opacity-70"},Co={class:"font-mono text-xs"},To={class:"flex items-center gap-1 opacity-70"},Mo={class:"font-mono text-xs"},So=P({__name:"GlobalTrafficIndicator",setup(w){const o=me(),n=$e(),a=G(),s=ie("globalTrafficIndicatorVisible",!0),d=ie("globalTrafficIndicatorCollapsed",!0),u=ie("globalTrafficIndicatorPosition",{x:-1,y:-1}),c=E(!1),f=E({x:0,y:0}),v=E(null),g=E(null);let b;const C=O(()=>o.latestTraffic?.down??0),x=O(()=>o.latestTraffic?.up??0),p=O(()=>o.latestMemory?.inuse??0),m=O(()=>n.latestConnectionMsg?.connections?.length??0),i=l=>et(l).toString(),$=O(()=>u.value.x===-1||u.value.y===-1?{right:"16px",bottom:"16px"}:{left:`${u.value.x}px`,top:`${u.value.y}px`});function M(){s.value=!s.value}function D(){d.value=!d.value}function I(){d.value=!1,u.value={x:-1,y:-1}}function H(l){if(!v.value)return;c.value=!0;const S=v.value.getBoundingClientRect(),ae="touches"in l?l.touches[0].clientX:l.clientX,X="touches"in l?l.touches[0].clientY:l.clientY;f.value={x:ae-S.left,y:X-S.top},u.value.x===-1&&(u.value.x=S.left,u.value.y=S.top),document.addEventListener("mousemove",R),document.addEventListener("mouseup",U),document.addEventListener("touchmove",R),document.addEventListener("touchend",U)}function R(l){if(!c.value)return;const S="touches"in l?l.touches[0].clientX:l.clientX,ae="touches"in l?l.touches[0].clientY:l.clientY;let X=S-f.value.x,re=ae-f.value.y;const ve=v.value?.getBoundingClientRect(),Ie=ve?.width||200,ze=ve?.height||150;X=Math.max(0,Math.min(window.innerWidth-Ie,X)),re=Math.max(0,Math.min(window.innerHeight-ze,re)),u.value.x=X,u.value.y=re}function U(){c.value&&(c.value=!1,document.removeEventListener("mousemove",R),document.removeEventListener("mouseup",U),document.removeEventListener("touchmove",R),document.removeEventListener("touchend",U))}function K(){if(!g.value)return;b&&(b.destroy(),b=void 0);const l=_e(),S=g.value.offsetWidth||200;b=be.chart(g.value,{chart:{type:"areaspline",backgroundColor:"transparent",spacing:[0,0,0,0],margin:[0,0,0,0],animation:!1,width:S,height:48},credits:{enabled:!1},accessibility:{enabled:!1},title:{text:void 0},legend:{enabled:!1},xAxis:{visible:!1,type:"datetime"},yAxis:{visible:!1,min:0},tooltip:{enabled:!1},plotOptions:{areaspline:{lineWidth:1.5,marker:{enabled:!1},fillOpacity:.2,animation:!1}},series:[{type:"areaspline",name:"Upload",color:l.seriesColors[0],data:o.trafficChartHistory.upload.length>0?[...o.trafficChartHistory.upload].slice(-30):[[Date.now(),0]]},{type:"areaspline",name:"Download",color:l.seriesColors[1],data:o.trafficChartHistory.download.length>0?[...o.trafficChartHistory.download].slice(-30):[[Date.now(),0]]}]})}function Le(){if(!b)return;const l=[...o.trafficChartHistory.download].slice(-30),S=[...o.trafficChartHistory.upload].slice(-30);b.series[0]?.setData(S,!1),b.series[1]?.setData(l,!0)}function De(){if(!z)return;const l=[...o.trafficChartHistory.download].slice(-30),S=[...o.trafficChartHistory.upload].slice(-30);z.series[0]?.setData(S,!1),z.series[1]?.setData(l,!0)}function Z(){if(!B.value)return;z&&(z.destroy(),z=void 0);const l=_e();z=be.chart(B.value,{chart:{type:"areaspline",backgroundColor:"transparent",spacing:[0,0,0,0],margin:[0,0,0,0],animation:!1,height:40},credits:{enabled:!1},accessibility:{enabled:!1},title:{text:void 0},legend:{enabled:!1},xAxis:{visible:!1,type:"datetime"},yAxis:{visible:!1,min:0},tooltip:{enabled:!1},plotOptions:{areaspline:{lineWidth:1.5,marker:{enabled:!1},fillOpacity:.2,animation:!1}},series:[{type:"areaspline",name:"Upload",color:l.seriesColors[0],data:o.trafficChartHistory.upload.length>0?[...o.trafficChartHistory.upload].slice(-30):[[Date.now(),0]]},{type:"areaspline",name:"Download",color:l.seriesColors[1],data:o.trafficChartHistory.download.length>0?[...o.trafficChartHistory.download].slice(-30):[[Date.now(),0]]}]})}j(()=>o.latestTraffic,l=>{l&&(b?Le():g.value&&s.value&&!d.value&&K(),z?De():B.value&&Z())}),j(()=>a.curTheme,()=>{g.value&&!d.value&&s.value&&K(),B.value&&Z()}),j(d,l=>{!l&&s.value?ee(()=>{setTimeout(()=>{g.value&&o.latestTraffic&&K()},50)}):l&&b&&(b.destroy(),b=void 0)}),j(s,l=>{l&&!d.value?ee(()=>{setTimeout(()=>{g.value&&o.latestTraffic&&K()},50)}):!l&&b&&(b.destroy(),b=void 0)}),j(()=>a.sidebarExpanded,l=>{l&&ee(()=>{setTimeout(()=>{B.value&&o.latestTraffic&&Z()},100)})});const se=E(!1),ne=E(!1),he=E(!1),B=E(null);let z;return F(()=>{ee(()=>{se.value=!!document.getElementById("header-traffic-indicator"),ne.value=!!document.getElementById("sidebar-traffic-indicator"),he.value=!!document.getElementById("sidebar-traffic-expanded")}),s.value&&!d.value&&o.latestTraffic&&setTimeout(()=>{g.value&&K()},100),o.latestTraffic&&setTimeout(()=>{B.value&&Z()},150)}),je(()=>{b&&(b.destroy(),b=void 0),z&&(z.destroy(),z=void 0)}),(l,S)=>(r(),_(V,null,[e(se)?(r(),L(J,{key:0,to:"#header-traffic-indicator"},[e(s)&&e(d)&&e(o).latestTraffic?(r(),_("div",{key:0,class:"flex cursor-pointer items-center gap-2 rounded-lg bg-[color-mix(in_oklch,var(--color-base-100)_50%,transparent)] px-2 py-1 transition-[background] duration-200 ease-in-out hover:bg-[var(--color-base-100)]",onClick:I},[t("div",Gt,[h(e(Y),{class:"size-3 shrink-0 text-[var(--color-success)]"}),t("span",Kt,y(i(e(C)))+"/s",1)]),S[0]||(S[0]=t("div",{class:"h-3 w-px bg-[color-mix(in_oklch,var(--color-base-content)_20%,transparent)]"},null,-1)),t("div",Xt,[h(e(A),{class:"size-3 shrink-0 text-[var(--color-info)]"}),t("span",Yt,y(i(e(x)))+"/s",1)])])):T("",!0)])):T("",!0),e(ne)?(r(),L(J,{key:1,to:"#sidebar-traffic-indicator"},[e(o).latestTraffic?(r(),_("div",{key:0,class:"w-full cursor-pointer rounded-lg bg-[color-mix(in_oklch,var(--color-base-100)_50%,transparent)] p-2 transition-[background] duration-200 ease-in-out hover:bg-[var(--color-base-100)]",onClick:I},[t("div",Jt,[h(e(Y),{class:"size-3 shrink-0 text-[var(--color-success)]"}),t("span",qt,y(i(e(C)))+"/s",1)]),t("div",Qt,[h(e(A),{class:"size-3 shrink-0 text-[var(--color-info)]"}),t("span",Zt,y(i(e(x)))+"/s",1)])])):T("",!0)])):T("",!0),e(he)?(r(),L(J,{key:2,to:"#sidebar-traffic-expanded"},[e(o).latestTraffic?(r(),_("div",eo,[t("div",{ref_key:"sidebarChartContainer",ref:B,class:"mb-2 h-10 w-full"},null,512),t("div",to,[t("div",oo,[h(e(Y),{class:"size-3 shrink-0 text-[var(--color-success)]"}),t("span",so,y(i(e(C)))+"/s",1)]),t("div",no,[h(e(A),{class:"size-3 shrink-0 text-[var(--color-info)]"}),t("span",ao,y(i(e(x)))+"/s",1)])])])):T("",!0)])):T("",!0),e(s)&&e(d)&&e(o).latestTraffic&&!e(se)&&!e(ne)?(r(),_("div",{key:3,class:"fixed right-4 bottom-4 z-50 flex cursor-pointer items-center gap-2 rounded-xl bg-[var(--color-base-200)] px-3 py-2 shadow-lg",onClick:I},[t("div",ro,[h(e(Y),{class:"size-3 shrink-0 text-[var(--color-success)]"}),t("span",io,y(i(e(C)))+"/s",1)]),S[1]||(S[1]=t("div",{class:"h-3 w-px bg-[color-mix(in_oklch,var(--color-base-content)_20%,transparent)]"},null,-1)),t("div",lo,[h(e(A),{class:"size-3 shrink-0 text-[var(--color-info)]"}),t("span",co,y(i(e(x)))+"/s",1)])])):T("",!0),e(s)?T("",!0):(r(),_("button",{key:4,class:"fixed right-4 bottom-4 z-50 flex size-8 cursor-pointer items-center justify-center rounded-full border-none bg-[var(--color-primary)] text-[var(--color-primary-content)] shadow-lg transition-all duration-200 ease-in-out hover:scale-110",title:l.$t("showTrafficIndicator"),onClick:M},[h(e(A),{class:"size-4"})],8,uo)),h(fe,{name:"traffic-expand"},{default:N(()=>[e(s)&&!e(d)&&e(o).latestTraffic?(r(),_("div",{key:0,ref_key:"containerRef",ref:v,class:k(["fixed z-50 min-w-56 rounded-xl bg-[var(--color-base-200)] shadow-lg select-none",{"cursor-grabbing":e(c)}]),style:oe(e($))},[t("div",fo,[t("div",po,[t("div",{class:"flex cursor-grab items-center gap-1 active:cursor-grabbing",onMousedown:H,onTouchstart:H},[h(e(tt),{class:"size-4 opacity-40"}),t("span",mo,y(l.$t("traffic")),1)],32),t("div",ho,[t("button",{class:"flex size-6 cursor-pointer items-center justify-center rounded-full border-none bg-transparent text-[var(--color-base-content)] transition-[background] duration-200 ease-in-out hover:bg-[color-mix(in_oklch,var(--color-base-content)_10%,transparent)]",title:l.$t("hideTrafficIndicator"),onClick:D},[...S[2]||(S[2]=[t("span",{class:"text-xs"},"âˆ’",-1)])],8,vo),t("button",{class:"flex size-6 cursor-pointer items-center justify-center rounded-full border-none bg-transparent text-[var(--color-base-content)] transition-[background] duration-200 ease-in-out hover:bg-[color-mix(in_oklch,var(--color-base-content)_10%,transparent)]",title:l.$t("hideTrafficIndicator"),onClick:M},[h(e(ot),{class:"size-3"})],8,bo)])]),t("div",{ref_key:"chartContainer",ref:g,class:"h-12 w-full"},null,512),t("div",_o,[t("div",go,[h(e(Y),{class:"size-3 shrink-0 text-[var(--color-success)]"}),t("span",xo,y(i(e(C)))+"/s ",1)]),t("div",yo,[h(e(A),{class:"size-3 shrink-0 text-[var(--color-info)]"}),t("span",ko,y(i(e(x)))+"/s ",1)]),t("div",wo,[t("span",null,y(l.$t("memory"))+":",1),t("span",Co,y(i(e(p))),1)]),t("div",To,[t("span",null,y(l.$t("connections"))+":",1),t("span",Mo,y(e(m)),1)])])])],6)):T("",!0)]),_:1})],64))}}),Eo=Object.assign(Se(So,[["__scopeId","data-v-b584cc8c"]]),{__name:"GlobalTrafficIndicator"}),$o={class:"modal-box max-w-lg"},Lo={class:"flex items-center justify-between border-b border-base-300 pb-3"},Do={class:"text-lg font-bold"},Io={class:"mt-4 space-y-6"},zo={class:"mb-2 text-sm font-semibold text-base-content/70"},Ho={class:"space-y-1"},Oo={class:"text-sm"},jo={class:"kbd kbd-sm"},Po={class:"mt-6 text-center text-xs text-base-content/50"},Ro=P({__name:"ShortcutsHelpModal",setup(w){const o=pe(),{t:n}=de(),a=Pe("(max-width: 768px)"),s=()=>{o.closeHelpModal()};return(d,u)=>e(a)?T("",!0):(r(),_("dialog",{key:0,class:k(["modal",{"modal-open":e(o).isHelpModalOpen}]),onClick:ue(s,["self"])},[t("div",$o,[t("div",Lo,[t("h3",Do,y(e(n)("shortcuts.title","Keyboard Shortcuts")),1),t("button",{class:"btn btn-circle btn-ghost btn-sm",onClick:s},[...u[0]||(u[0]=[t("span",{class:"i-tabler-x size-5"},null,-1)])])]),t("div",Io,[(r(!0),_(V,null,q(e(Fe),c=>(r(),_("div",{key:c.id},[t("h4",zo,y(e(n)(c.labelKey,c.id)),1),t("div",Ho,[(r(!0),_(V,null,q(c.shortcuts,f=>(r(),_("div",{key:f,class:"flex items-center justify-between rounded px-2 py-1.5 hover:bg-base-200"},[t("span",Oo,y(e(n)(e(We)[f],f)),1),t("kbd",jo,y(e(Ve)(e(o).shortcuts[f])),1)]))),128))])]))),128))]),t("div",Po,y(e(n)("shortcuts.pressEscToClose","Press Esc to close")),1)]),t("form",{method:"dialog",class:"modal-backdrop",onClick:s},[...u[1]||(u[1]=[t("button",null,"close",-1)])])],2))}}),Bo=Object.assign(Ro,{__name:"ShortcutsHelpModal"});function No(){const w=Re(),o=pe(),n=Be(),a=O(()=>{const x=n.value;if(!x)return!1;const p=x.tagName.toLowerCase();return p==="input"||p==="textarea"||p==="select"||x.getAttribute("contenteditable")==="true"}),s=E(!1),d=E(null),u=()=>{s.value=!1,d.value&&(clearTimeout(d.value),d.value=null)},c=()=>{s.value=!0,d.value&&clearTimeout(d.value),d.value=setTimeout(u,1500)},f={goToOverview:()=>w.push(W.Overview),goToProxies:()=>w.push(W.Proxies),goToConnections:()=>w.push(W.Conns),goToRules:()=>w.push(W.Rules),goToLogs:()=>w.push(W.Log),goToConfig:()=>w.push(W.Config),refresh:()=>{window.dispatchEvent(new CustomEvent("shortcut:refresh"))},closeModal:()=>{o.isHelpModalOpen&&o.closeHelpModal(),window.dispatchEvent(new CustomEvent("shortcut:close-modal"))},showHelp:()=>{o.toggleHelpModal()}},v=x=>{const p=f[x];p&&p()},g={o:"goToOverview",p:"goToProxies",c:"goToConnections",u:"goToRules",l:"goToLogs",s:"goToConfig"},b=x=>{if(a.value)return;const p=x.key.toLowerCase();if(p==="escape"){v("closeModal");return}if(x.shiftKey&&(p==="/"||p==="?")){x.preventDefault(),v("showHelp");return}if(p==="g"&&!s.value){c();return}if(s.value){const m=g[p];if(m){x.preventDefault(),v(m),u();return}}p==="r"&&!s.value&&v("refresh")},C=()=>{window.addEventListener("keydown",b)};return te(()=>{window.removeEventListener("keydown",b),u()}),{isInputFocused:a,gPrefixActive:s,setupKeyboardListeners:C,executeAction:v}}const Uo=["data-theme"],ls=P({__name:"default",setup(w){const o=G(),n=ce(),a=me();pe();const{setupKeyboardListeners:s}=No();F(()=>{s()});const d=E(null);j(d,f=>{f&&(a.rootElement=f)});const u=Ne();j([()=>o.autoSwitchTheme,u],([f,v])=>{f&&(o.curTheme=v?o.favNightTheme:o.favDayTheme)},{immediate:!0}),j(()=>o.curTheme,f=>{document.documentElement.setAttribute("data-theme",f)},{immediate:!0});const c=O(()=>Ee()||!!n.currentEndpoint);return(f,v)=>{const g=Nt,b=Ft,C=Eo,x=Bo;return r(),_("div",{ref_key:"rootElement",ref:d,class:k(["relative h-screen overscroll-y-none bg-base-100 antialiased",e(o).enableTwemoji?"font-twemoji":"font-default"]),"data-theme":e(o).curTheme},[h(g,null,{default:N(()=>[ye(f.$slots,"default")]),_:3}),e(c)?(r(),L(b,{key:0})):T("",!0),e(c)?(r(),L(C,{key:1})):T("",!0),h(x)],10,Uo)}}});export{ls as default};
