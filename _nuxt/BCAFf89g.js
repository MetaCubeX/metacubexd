import{_ as T}from"./BqWuE--e.js";import{e as K,f as O,u as X,B as q,J as G,A as H,C as P,c as p,a as o,b as f,i as e,D as J,t as x,p as S,j as I,v as B,m as U,F as D,r as V,w as Q,K as W,z as E,y as Y,o as m,d as Z,q as tt,L as et}from"./CRZAT9oH.js";import{c as j}from"./qqqfUOwc.js";import{I as M}from"./ofacdJHf.js";import{I as nt}from"./DwBSywMz.js";import{c as A}from"./BD4k13ts.js";import{F as _}from"./vIF72wqi.js";import{t as ot}from"./Du_FUPRh.js";import{_ as st}from"./DlAUqK2U.js";var rt=j("outline","link","Link",[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]]);var at=j("outline","lock","Lock",[["path",{d:"M5 13a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-6",key:"svg-0"}],["path",{d:"M11 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}],["path",{d:"M8 11v-4a4 4 0 1 1 8 0v4",key:"svg-2"}]]);const i=[];for(let t=0;t<256;++t)i.push((t+256).toString(16).slice(1));function it(t,n=0){return(i[t[n+0]]+i[t[n+1]]+i[t[n+2]]+i[t[n+3]]+"-"+i[t[n+4]]+i[t[n+5]]+"-"+i[t[n+6]]+i[t[n+7]]+"-"+i[t[n+8]]+i[t[n+9]]+"-"+i[t[n+10]]+i[t[n+11]]+i[t[n+12]]+i[t[n+13]]+i[t[n+14]]+i[t[n+15]]).toLowerCase()}let R;const lt=new Uint8Array(16);function dt(){if(!R){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");R=crypto.getRandomValues.bind(crypto)}return R(lt)}const ct=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),N={randomUUID:ct};function ut(t,n,g){t=t||{};const u=t.random??t.rng?.()??dt();if(u.length<16)throw new Error("Random bytes length must be >= 16");return u[6]=u[6]&15|64,u[8]=u[8]&63|128,it(u)}function pt(t,n,g){return N.randomUUID&&!t?N.randomUUID():ut(t)}const mt={class:"flex h-full items-center justify-center overflow-y-auto bg-gradient-to-b from-base-100 to-base-200 p-4"},ft={class:"animate-fade-slide-in mx-auto w-full max-w-md"},bt={class:"animate-fade-slide-in-delay-1 mb-8 text-center"},ht={class:"mb-4"},xt={class:"shadow-primary-glow mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-2xl bg-gradient-to-br from-primary to-secondary text-primary-content"},yt={class:"text-[0.9375rem] text-base-content/60"},vt={class:"shadow-card animate-fade-slide-in-delay-2 rounded-2xl border border-base-content/8 bg-base-200/80 p-6 backdrop-blur-md"},_t={class:"flex flex-col gap-2"},gt={class:"flex items-center gap-2 text-sm font-medium text-base-content/70",for:"url"},wt={id:"defaultEndpoints"},kt=["value"],Lt=["value"],Ut=["value"],Et=["value"],Rt={class:"flex flex-col gap-2"},Ct={class:"flex items-center gap-2 text-sm font-medium text-base-content/70",for:"secret"},St={key:0,class:"animate-fade-slide-in-delay-3 mt-6"},It={class:"flex flex-col gap-3"},Bt=["onClick"],Dt={class:"flex h-7 w-7 shrink-0 items-center justify-center rounded-md bg-info/20 text-info"},Vt={class:"min-w-0 flex-1 overflow-hidden text-[0.8125rem] font-medium text-ellipsis whitespace-nowrap text-base-content"},Mt=["onClick"],At=K({__name:"setup",setup(t){const{t:n}=O();X({title:E(()=>n("setup"))});const g=q(),u=G(),l=H(),d=W({url:"",secret:""}),y=Y(!1),C=et(),v=E(()=>C.public.defaultBackendURL?C.public.defaultBackendURL:typeof window<"u"&&window.__METACUBEXD_CONFIG__?.defaultBackendURL?window.__METACUBEXD_CONFIG__.defaultBackendURL:_),w=E(()=>typeof window>"u"?"":window.location.origin);function k(r){l.setSelectedEndpoint(r),g.replace("/overview")}async function z(r){const s=l.endpointList.find(c=>c.id===r);s&&await A(s.url,s.secret)&&k(r)}async function L(){y.value=!0;try{const r=d.url,s=d.secret,c=ot(r);if(!await A(c,s)){y.value=!1;return}const a=pt(),b=[...l.endpointList],h=b.find(F=>F.url===c);if(!h){l.setEndpointList([{id:a,url:c,secret:s},...b]),k(a);return}h.secret=s,h.id=a,l.setEndpointList(b),k(a)}finally{y.value=!1}}function $(r){l.removeEndpoint(r)}return P(async()=>{const r=u.query||(typeof window<"u"?new URLSearchParams(window.location.search):null);if(r&&typeof r=="object"){const s=r.hostname;if(s){const c=r.http?"http:":r.https?"https:":typeof window<"u"?window.location.protocol:"http:",a=r.port?`:${r.port}`:"";d.url=`${c}//${s}${a}`,d.secret=r.secret||"",await L();return}}l.endpointList.length===0&&(d.url=v.value,d.secret="",await L())}),(r,s)=>{const c=T;return m(),p("div",mt,[o("div",ft,[o("div",bt,[o("div",ht,[o("div",xt,[f(e(M),{size:32})]),s[2]||(s[2]=J('<h1 class="text-3xl font-bold tracking-wide uppercase sm:text-4xl" data-v-c3b401bc><span class="bg-gradient-to-br from-primary to-secondary bg-clip-text text-transparent" data-v-c3b401bc>metacube</span><span class="text-base-content" data-v-c3b401bc>(</span><a class="inline-block text-primary no-underline transition-all duration-300 hover:scale-110 hover:rotate-5" href="https://github.com/metacubex/metacubexd" target="_blank" data-v-c3b401bc> xd </a><span class="text-base-content" data-v-c3b401bc>)</span></h1>',1))]),o("p",yt,x(e(n)("setupDescription")),1)]),o("div",vt,[o("form",{class:"flex flex-col gap-5",onSubmit:S(L,["prevent"])},[o("div",_t,[o("label",gt,[f(e(rt),{size:16}),o("span",null,x(e(n)("endpointURL")),1)]),I(o("input",{id:"url","onUpdate:modelValue":s[0]||(s[0]=a=>e(d).url=a),type:"url",class:"w-full rounded-lg border border-base-content/15 bg-base-100/80 px-4 py-3 text-[0.9375rem] text-base-content transition-all duration-200 placeholder:text-base-content/40 focus:border-primary focus:ring-3 focus:ring-primary/20 focus:outline-none",placeholder:"http(s)://{hostname}:{port}",list:"defaultEndpoints",autocomplete:"on"},null,512),[[B,e(d).url]]),o("datalist",wt,[o("option",{value:e(_)},null,8,kt),e(v)&&e(v)!==e(_)?(m(),p("option",{key:0,value:e(v)},null,8,Lt)):U("",!0),e(w)&&e(w)!==e(_)?(m(),p("option",{key:1,value:e(w)},null,8,Ut)):U("",!0),(m(!0),p(D,null,V(e(l).endpointList,a=>(m(),p("option",{key:a.id,value:a.url},null,8,Et))),128))])]),s[3]||(s[3]=o("input",{type:"text",name:"username",autocomplete:"username",class:"sr-only","aria-hidden":"true",tabindex:"-1"},null,-1)),o("div",Rt,[o("label",Ct,[f(e(at),{size:16}),o("span",null,x(e(n)("secret")),1)]),I(o("input",{id:"secret","onUpdate:modelValue":s[1]||(s[1]=a=>e(d).secret=a),type:"password",class:"w-full rounded-lg border border-base-content/15 bg-base-100/80 px-4 py-3 text-[0.9375rem] text-base-content transition-all duration-200 placeholder:text-base-content/40 focus:border-primary focus:ring-3 focus:ring-primary/20 focus:outline-none",placeholder:"secret",autocomplete:"current-password"},null,512),[[B,e(d).secret]])]),f(c,{type:"submit",class:"hover:shadow-primary-glow-lg w-full cursor-pointer rounded-lg border-none bg-gradient-to-br from-primary to-secondary px-6 py-3.5 text-[0.9375rem] font-semibold tracking-widest text-primary-content uppercase transition-all duration-300 hover:-translate-y-0.5",loading:e(y)},{default:Q(()=>[Z(x(e(n)("add")),1)]),_:1},8,["loading"])],32)]),e(l).endpointList.length>0?(m(),p("div",St,[s[4]||(s[4]=o("h3",{class:"mb-3 text-[0.8125rem] font-semibold tracking-widest text-base-content/50 uppercase"}," Saved Endpoints ",-1)),o("div",It,[(m(!0),p(D,null,V(e(l).endpointList,(a,b)=>(m(),p("div",{key:a.id,class:"animate-fade-slide-in flex cursor-pointer items-center gap-2 rounded-xl border border-info/20 bg-info/10 p-3 transition-all duration-200 hover:-translate-y-0.5 hover:border-info/30 hover:bg-info/15",style:tt({animationDelay:`${b*50}ms`}),onClick:h=>z(a.id)},[o("div",Dt,[f(e(M),{size:16})]),o("span",Vt,x(a.url),1),o("button",{class:"flex h-6 w-6 shrink-0 cursor-pointer items-center justify-center rounded-full border-none bg-transparent text-base-content/50 transition-all duration-200 hover:bg-error/15 hover:text-error",onClick:S(h=>$(a.id),["stop"])},[f(e(nt),{size:14})],8,Mt)],12,Bt))),128))])])):U("",!0)])])}}}),qt=st(At,[["__scopeId","data-v-c3b401bc"]]);export{qt as default};
